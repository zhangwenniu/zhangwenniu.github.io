<!-- Gitalk 评论组件 -->
{% if site.gitalk.enable %}
<div id="gitalk-container"></div>

<!-- 引入 Gitalk 相关资源 -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>

<script>
  // 获取页面唯一标识
  var gitalkId = '{{ page.url | slugify }}';
  // 如果标识超过50个字符，则取其哈希值的后50个字符
  if (gitalkId.length > 50) {
    gitalkId = gitalkId.substr(gitalkId.length - 50);
  }
  
  var gitalk = new Gitalk({
    clientID: "{{ site.gitalk.clientID }}",
    clientSecret: "{{ site.gitalk.clientSecret }}",
    repo: "{{ site.gitalk.repo }}", // 存储评论的仓库
    owner: "{{ site.gitalk.owner }}", // 仓库所有者
    admin: {{ site.gitalk.admin | jsonify }}, // 仓库管理员，可以有多个
    id: gitalkId, // 页面唯一标识，长度必须小于50
    title: "{{ page.title }}", // 页面标题
    distractionFreeMode: false // 是否启用无干扰模式
  });
  
  gitalk.render('gitalk-container');
</script>

<style>
  /* Gitalk 样式调整 */
  #gitalk-container {
    margin-top: 30px;
  }
  
  /* 暗色模式支持 */
  html.dark .gt-container .gt-btn {
    background-color: #30363d;
    border-color: #30363d;
  }
  
  html.dark .gt-container .gt-btn-preview {
    background-color: #161b22;
    color: #c9d1d9;
  }
  
  html.dark .gt-container .gt-header-textarea {
    background-color: #0d1117;
    color: #c9d1d9;
    border-color: #30363d;
  }
  
  html.dark .gt-container .gt-header-preview {
    background-color: #0d1117;
    color: #c9d1d9;
    border-color: #30363d;
  }
  
  html.dark .gt-container .gt-comment-content {
    background-color: #161b22;
    color: #c9d1d9;
    border-color: #30363d;
  }
  
  html.dark .gt-container .gt-comment-body {
    color: #c9d1d9;
  }
  
  html.dark .gt-container a {
    color: #58a6ff;
  }
  
  html.dark .gt-container .gt-svg svg {
    fill: #8b949e;
  }
</style>
{% endif %} 