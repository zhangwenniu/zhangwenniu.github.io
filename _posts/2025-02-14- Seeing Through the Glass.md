---
layout: mypost
title: Seeing Through the Glass, Neural 3D Reconstruction of Object Inside a  Transparent Container
categories: [透明物体]
---

# 链接

- Arxiv: [Seeing Through the Glass](https://arxiv.org/abs/2303.13805)
- [CVPR 2023 论文海报](https://cvpr.thecvf.com/virtual/2023/poster/20985)

- 发表时间

[v1] 2023年3月24日，04:58:27 UTC (21,246 KB)

# 文章难点解析

这篇论文是关于如何通过透明容器看到里面物体的3D形状，并重建出来。这是一个很有挑战性的问题，因为透明容器会让光线发生多次反射和折射，导致图像失真。传统的3D重建方法在这种情况下通常会失败。

## 研究背景

这篇论文的灵感来源于博物馆数字化藏品的需求。许多珍贵的文物或标本（如昆虫、水生生物等）被保存在透明材料（如玻璃或树脂）中。为了在虚拟现实或元宇宙中展示这些藏品，我们需要重建这些被透明容器包裹的物体的3D形状。

## 研究问题
论文提出一个新的问题：如何从多个2D视角重建透明容器内物体的3D几何形状。透明容器会让光线在空气和玻璃界面之间多次反射和折射，导致图像失真，使得传统的3D重建方法（如运动恢复结构SfM或神经辐射场NeRF）无法准确重建。

## 解决方案：ReNeuS

为了解决这个问题，作者提出了一种新的方法，叫做ReNeuS（Refraction and Reflection Neural Surface）。这个方法的核心思想是将场景分为两个部分：容器内部（包含目标物体）和外部（空气）。然后，他们用一种混合渲染策略（结合光线追踪和体积渲染）来处理光线在两个部分之间的交互。

关键点：

神经隐式表示：使用神经网络来表示物体的几何形状和外观。这种表示方式可以高效地处理复杂的形状和外观。

混合渲染策略：通过光线追踪处理反射和折射，然后用体积渲染来计算光线在容器内部的传播。这种策略可以更真实地模拟光线在透明容器中的行为。

优化网络参数：通过最小化真实图像和渲染图像之间的差异来优化网络参数，从而重建出物体的3D形状。

## 实验

作者为了验证他们的方法，创建了两个数据集：一个是合成数据集，包含13个复杂外观或几何形状的物体；另一个是真实数据集，包含10个被玻璃容器包裹的昆虫标本。

实验结果：

ReNeuS在合成数据集上表现优于现有的最先进方法（如COLMAP、IDR和NeuS），尤其是在处理透明容器时。
在真实数据集上，ReNeuS能够成功重建昆虫的翅膀和触角等细节，这些细节在传统方法中很难重建。

## 局限性

尽管ReNeuS取得了很好的结果，但它也有一些局限性：

假设透明容器的几何形状已知，且背景是均匀的。如果容器形状不规则或背景复杂，可能会导致性能下降。

未来的研究方向可能包括联合重建物体和容器，以及建模光照条件。

## 总结

这篇论文提出了一种新的方法，用于重建透明容器内物体的3D形状。通过结合神经隐式表示和混合渲染策略，ReNeuS能够处理复杂的光线反射和折射，从而在现有方法失败的情况下成功重建出高质量的3D模型。




# **方法概述**
ReNeuS 的核心思想是将场景分为两个子空间：
1. **内部空间（Sin）**：包含目标物体的透明容器内部。
2. **外部空间（Sout）**：容器外部的空气空间。

通过这种划分，ReNeuS 可以分别处理内部物体的几何和外观信息，同时处理光线在两个子空间之间的复杂交互（如反射和折射）。最终，通过优化网络参数，使得渲染图像与真实图像之间的差异最小化，从而重建出物体的 3D 几何形状。

### **1. 神经隐式表面（Neural Implicit Surface）**
ReNeuS 基于 NeuS 方法，使用神经网络隐式地表示场景的几何和外观。具体来说，它包含两个独立的多层感知机（MLP）：
- **几何 MLP（gθ）**：将场景表示为一个符号距离函数（SDF），输入点坐标 $ x $，输出该点到表面的距离值 $ s $。通过 SDF，可以从零等值面提取物体表面。
- **外观 MLP（fϕ）**：表示点的辐射信息，输入点的位置 $ x $、视图方向 $ v $ 和法向量 $ n $，输出该点的辐射值 $ c $。

这种表示方式能够高效地处理复杂的几何形状和外观信息。

### **2. 混合渲染策略（Hybrid Rendering Strategy）**
ReNeuS 的关键创新之一是混合渲染策略，结合了光线追踪（ray tracing）和体积渲染（volume rendering），以处理光线在两个子空间之间的交互。

#### **2.1 光线追踪（Ray Tracing）**
在 ReNeuS 中，光线追踪用于模拟光线在透明容器界面的反射和折射。具体步骤如下：
1. **计算交点**：对于从相机发出的光线 $ \ell_i $，计算它与透明容器的交点。如果没有交点，则终止追踪。
2. **反射和折射光线**：如果光线与容器相交，根据反射定律和斯涅尔定律（Snell's Law），计算反射光线 $ \ell_r $ 和折射光线 $ \ell_t $。
3. **递归追踪**：对反射光线和折射光线递归地进行追踪，直到达到预设的递归深度 $ D_{re} $。

#### **2.2 体积渲染（Volume Rendering）**
对于内部空间 Sin，使用体积渲染来计算光线的颜色。具体来说：
- 对于内部光线，根据其位置和方向，通过外观 MLP 获取其辐射值 $ c(x, d) $。
- 使用体积渲染公式（如 Eq. 2）计算光线的颜色，考虑光线在空间中的衰减和累积。

#### **2.3 颜色累积（Color Accumulation）**
最终，光线的颜色通过累积所有子光线的颜色来计算。具体步骤如下：
1. 对于每个子光线 $ m_i $，根据其是否在内部空间 Sin 或外部空间 Sout，分别获取其颜色。
2. 按照光线追踪的逆序累积颜色，同时考虑反射和折射的权重（如 Eq. 8 和 Eq. 9）。
3. 在穿过 Sin 时，进一步乘以沿光线的累积透射率 $ T_\ell $。



### **3. 损失函数（Loss Function）**
为了优化网络参数，ReNeuS 使用以下损失函数：
1. **光度损失（Photometric Loss）**：计算渲染图像与真实图像之间的 L1 损失。
2. **透明度正则化（Transmittance Regularization）**：假设 Sin 的大部分区域应该是透明的，通过正则化透射率来抑制不必要的几何结构。
3. **几何正则化（Geometric Regularization）**：使用 Eikonal 正则化，确保几何 MLP 的梯度接近于 1。

通过最小化这些损失，ReNeuS 能够优化网络参数，重建出高质量的 3D 模型。



### **4. 方法的优势**
ReNeuS 的方法有以下关键优势：
1. **处理复杂光线交互**：通过混合渲染策略，ReNeuS 能够准确模拟光线在透明容器中的反射和折射，解决了传统方法在复杂光学场景下的失效问题。
2. **神经隐式表示**：使用 SDF 和体积渲染，能够高效地表示复杂的几何形状和外观信息。
3. **优化驱动的重建**：通过最小化渲染图像与真实图像之间的差异，ReNeuS 能够自适应地优化网络参数，从而重建出高质量的 3D 模型。



### **总结**
ReNeuS 的方法通过将场景划分为内部和外部子空间，并结合光线追踪和体积渲染，能够有效地处理透明容器内的复杂光线交互。通过优化网络参数，ReNeuS 能够重建出高质量的 3D 模型，即使在传统方法失败的情况下也能成功。这种方法为透明容器内物体的 3D 重建提供了一个强大的解决方案。




# 透明度正则化（Transmittance Regularization）

透明度正则化（Transmittance Regularization）是 ReNeuS 方法中一个关键的正则化技术，它的目的是利用透明容器的物理特性来约束神经网络的优化过程，从而提高重建结果的质量和稳定性。


### **透明度正则化的背景和动机**
在 ReNeuS 的场景中，透明容器内部（Sin）大部分区域是空的，只有目标物体占据了一小部分空间。这意味着，除了物体本身，透明容器内部的大部分区域应该是“透明”的，即光线可以无障碍地通过这些区域。

然而，在神经网络的优化过程中，如果不加以约束，网络可能会在这些透明区域生成不必要的几何结构（例如虚假的表面或体积），从而导致重建结果的不准确。为了避免这种情况，透明度正则化被引入，以确保透明容器内部的大部分区域保持透明。

### **透明度正则化的具体实现**
透明度正则化的核心思想是通过正则化项来约束光线在透明容器内部的透射率（Transmittance），使得这些区域尽可能保持透明。具体来说，透射率 $ T_\ell $ 表示光线在穿过某个区域时未被吸收或散射的概率。在一个完全透明的区域中，透射率应该接近于1。

#### **数学表达**
在 ReNeuS 的损失函数中，透明度正则化项 $ L_{\text{trans}} $ 的定义如下：

$$
L_{\text{trans}} = \frac{1}{|M_{\text{in}}|} \sum_{p \in M_{\text{in}}} \sum_{\ell \in L_p \cap S_{\text{in}}} \| 1 - T_\ell \|
$$

其中：
- $ M_{\text{in}} $ 是透明容器内部的像素集合。
- $ L_p $ 是从像素 $ p $ 发出的光线经过追踪后生成的光线集合。
- $ S_{\text{in}} $ 是透明容器内部的空间。
- $ T_\ell $ 是光线 $ \ell $ 在穿过透明容器内部时的透射率。

#### **物理意义**
- **$ 1 - T_\ell $**：表示光线在穿过某个区域时被吸收或散射的程度。如果 $ T_\ell $ 接近于1，则 $ 1 - T_\ell $ 接近于0，表示该区域是透明的。
- **正则化目标**：通过最小化 $ \| 1 - T_\ell \| $，使得透明容器内部的透射率尽可能接近于1，从而确保这些区域保持透明。

### **透明度正则化的作用**
1. **抑制虚假几何结构**：在优化过程中，网络可能会在透明容器内部生成不必要的几何结构（例如虚假的表面或体积）。透明度正则化通过约束透射率，使得这些区域保持透明，从而抑制了虚假几何结构的生成。
2. **提高重建质量**：通过确保透明容器内部的大部分区域保持透明，透明度正则化有助于网络更准确地重建目标物体的几何形状和外观。
3. **增强鲁棒性**：在处理复杂场景时，透明度正则化可以提高网络的鲁棒性，使其在不同条件下都能生成高质量的重建结果。


### **实验中的表现**
在论文的实验部分，作者通过对比实验验证了透明度正则化的效果。例如，在没有使用透明度正则化的情况下，网络可能会在透明容器内部生成虚假的边界或结构，导致重建结果的质量下降。而使用透明度正则化后，这些虚假结构被显著抑制，重建结果更加准确和稳定。


### **总结**
透明度正则化是 ReNeuS 方法中一个重要的技术，它通过约束透明容器内部的透射率，确保这些区域保持透明。这一正则化项不仅抑制了虚假几何结构的生成，还提高了重建结果的质量和鲁棒性，是 ReNeuS 能够成功重建透明容器内物体的关键因素之一。
