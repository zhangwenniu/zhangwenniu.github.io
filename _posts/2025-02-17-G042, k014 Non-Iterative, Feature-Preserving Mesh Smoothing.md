---
layout: mypost
title: G042, k014 Non-Iterative, Feature-Preserving Mesh Smoothing
categories: [平滑]
---

# 链接

- [论文链接](https://dl.acm.org/doi/10.1145/882262.882367)

- 发表时间：2023年1日

- 期刊：ACM Transactions on Graphics (TOG)


# 论文难点讲解

这篇论文是关于一种新型的三维网格平滑技术，旨在快速且有效地去除三维模型中的噪声，同时保留模型的重要特征（如锐角和边缘）。论文的核心思想是利用**鲁棒统计方法**和**局部预测器**来实现非迭代的特征保持网格平滑。

### 1. 研究背景
随着三维扫描技术的发展，越来越多的三维模型被创建出来。然而，这些模型通常会带有噪声（即不规则的、随机的误差），需要进行平滑处理。传统的平滑方法虽然可以去除噪声，但往往会模糊模型的细节特征（如尖角和边缘）。因此，研究者们需要开发一种既能去除噪声又能保持特征的平滑技术。

### 2. 传统方法的局限性
- **各向同性平滑**：这种方法对整个模型进行均匀平滑，无法区分噪声和重要特征，导致模型变得过于圆滑。
- **各向异性平滑**：这种方法尝试通过调整平滑的方向来保留特征，但通常需要多次迭代，并且对模型的拓扑结构（如是否连通）有要求，计算成本较高。



### 3. 论文提出的新方法
论文提出了一种**非迭代**的网格平滑方法，基于**鲁棒统计**和**局部预测器**。这种方法的核心思想是：
- **鲁棒统计**：通过一种特殊的统计方法，减少噪声（异常值）对平滑结果的影响，同时保留重要特征。
- **局部预测器**：利用网格的局部几何信息（如三角形的切平面）来预测每个顶点的新位置，而不是简单地对所有点进行平滑。



### 4. 方法的具体实现
1. **局部预测器**：每个三角形的切平面被用作局部预测器，用来预测顶点的新位置。
2. **权重函数**：通过空间权重和影响权重来控制平滑的程度。空间权重决定了哪些三角形会对顶点产生影响，而影响权重则决定了预测值的可靠性。
3. **平滑过程**：每个顶点的新位置是其邻域内所有预测值的加权平均。这种方法可以在一次计算中完成平滑，而不需要多次迭代。



### 5. 特征保持的关键
- **鲁棒性**：通过鲁棒统计方法，减少噪声对平滑结果的影响。
- **局部预测器**：利用切平面预测顶点位置，避免在尖锐特征处过度平滑。



### 6. 实验结果
论文通过多个实验展示了这种方法的有效性：
- **噪声去除**：能够有效地去除模型中的噪声，同时保持重要特征。
- **效率**：这种方法是非迭代的，计算速度快，适用于大规模网格。
- **适用性**：不需要输入网格是连通的，可以应用于“三角形汤”（即没有拓扑结构的三角形集合）。



### 7. 总结与展望
论文提出了一种快速、有效的网格平滑方法，能够很好地保留模型的特征。未来的工作可能包括：
- 进一步优化算法的效率。
- 将这种方法扩展到其他类型的几何数据（如点云）。
- 探索如何将鲁棒统计方法与其他几何处理技术结合。



# 详细讲解：非迭代特征保持网格平滑方法

## 1. 研究背景与动机
随着三维扫描技术的发展，越来越多的复杂三维模型被创建。然而，这些模型通常带有噪声，需要进行平滑处理。噪声可能来自扫描设备的精度限制，或者模型提取过程中的误差。平滑处理的目标是去除这些噪声，同时保留模型的重要几何特征（如尖角、边缘等）。

### 1.1 传统方法的局限性
- **各向同性平滑**：这种方法对整个模型进行均匀平滑，无法区分噪声和重要特征，导致模型变得过于圆滑。
- **各向异性平滑**：通过调整平滑的方向来保留特征，但通常需要多次迭代，计算成本较高，并且对模型的拓扑结构（如是否连通）有要求。
- **迭代方法的局限性**：大多数传统方法是迭代的，需要多次更新几何信息，这在处理大规模网格时效率较低。



## 2. 论文提出的新方法
论文提出了一种**非迭代**的网格平滑方法，基于**鲁棒统计**和**局部预测器**。这种方法的核心思想是将网格平滑视为一个鲁棒统计估计问题，通过局部预测器来估计每个顶点的新位置，同时利用鲁棒统计方法减少噪声的影响。

### 2.1 鲁棒统计（Robust Statistics）
鲁棒统计的目标是开发对异常值（outliers）和理论分布偏差不敏感的统计估计器。例如，传统的最小二乘法对异常值非常敏感，因为它的误差函数是二次的。而鲁棒估计器通过最小化一个特殊的能量函数（如高斯鲁棒范数），对异常值赋予较低的权重，从而减少它们的影响。

论文中提到，双边滤波（Bilateral Filtering）是一种非迭代的鲁棒估计器，它通过空间权重和信号权重来减少异常值的影响。这种方法在图像处理中已经取得了很好的效果，论文将其扩展到三维网格平滑中。

### 2.2 局部预测器（Local Predictors）
为了将网格平滑问题转化为鲁棒统计问题，论文引入了局部预测器。局部预测器的作用是根据网格的局部几何信息（如三角形的切平面）来预测每个顶点的新位置。具体来说，每个三角形的切平面被用作局部预测器，顶点的新位置是其邻域内所有预测值的加权平均。

### 2.3 方法的具体实现
1. **预测器的定义**：每个三角形的切平面定义了一个局部预测器，预测顶点的新位置。
2. **权重函数**：
   - **空间权重（Spatial Weight）**：根据顶点与三角形质心的距离计算，通常使用高斯函数。
   - **影响权重（Influence Weight）**：根据预测值与原始位置的差异计算，同样使用高斯函数。
3. **顶点的新位置**：顶点的新位置是其邻域内所有预测值的加权平均，权重由空间权重和影响权重决定。

公式如下：
- 新位置 $ p' $ 的计算公式：
  $$
  p' = \frac{1}{k(p)} \sum_{q \in S} \left[ \Pi_q(p) \cdot a_q \cdot f(\|c_q - p\|) \cdot g(\|\Pi_q(p) - p\|) \right]
  $$
- 归一化因子 $ k(p) $：
  $$
  k(p) = \sum_{q \in S} \left[ a_q \cdot f(\|c_q - p\|) \cdot g(\|\Pi_q(p) - p\|) \right]
  $$
其中：
- $ \Pi_q(p) $ 是基于三角形 $ q $ 的切平面预测的顶点 $ p $ 的新位置。
- $ a_q $ 是三角形 $ q $ 的面积。
- $ f $ 和 $ g $ 分别是空间权重和影响权重函数，通常使用高斯函数。

### 2.4 特征保持（Feature Preservation）
论文提出的方法通过以下两种方式实现特征保持：
1. **鲁棒影响权重函数**：通过影响权重函数 $ g $，对远离预测值的点赋予较低权重，从而减少噪声的影响。
2. **局部预测器**：基于切平面的预测器不会移动位于尖锐特征处的顶点，因为这些顶点的预测值来自两侧的平滑区域。

### 2.5 模糊化（Mollification）
为了进一步提高平滑效果，论文引入了模糊化技术。模糊化通过平滑法线来改善预测器的性能，但不会改变顶点的位置。具体步骤如下：
1. 使用简单的高斯平滑对法线进行一次非鲁棒平滑。
2. 将模糊化后的法线复制到原始网格的三角形上。
3. 使用鲁棒滤波器对网格进行平滑。

模糊化可以显著改善平滑效果，尤其是在处理噪声较大的网格时。



## 3. 实验结果
论文通过多个实验验证了提出方法的有效性。实验结果表明，该方法能够在一次计算中完成平滑，同时保持模型的重要特征。

### 3.1 与传统方法的对比
论文将提出的方法与传统的各向同性平滑方法（如 Desbrun 等人的方法）和各向异性平滑方法（如 Clarenz 等人的方法）进行了对比。结果表明：
- **各向同性平滑**：虽然能够平滑噪声，但会模糊模型的特征。
- **各向异性平滑**：虽然能够较好地保持特征，但需要多次迭代，计算成本较高。
- **提出的方法**：能够在一次计算中完成平滑，同时保持特征，效率更高。

### 3.2 参数调整
论文还探讨了参数 $ \sigma_f $ 和 $ \sigma_g $ 对平滑效果的影响：
- **$ \sigma_f $**：控制空间权重的范围，较大的 $ \sigma_f $ 会平滑更多的邻域，去除更多的噪声。
- **$ \sigma_g $**：控制影响权重的范围，较大的 $ \sigma_g $ 会允许更大的预测误差，从而保留更大的特征。

通过调整这些参数，可以实现不同程度的平滑和特征保持。



## 4. 结论与未来工作
论文提出了一种基于鲁棒统计的非迭代特征保持网格平滑方法。该方法具有以下优点：
- **非迭代**：一次计算即可完成平滑，效率高。
- **特征保持**：通过鲁棒统计和局部预测器，能够有效保持模型的重要特征。
- **适用性广**：不需要输入网格是连通的，可以应用于任意“三角形汤”。

### 4.1 未来工作
论文提出了以下未来工作的方向：
1. **优化算法效率**：虽然当前算法的复杂度为 $ O(\sigma_f^2) $，但在处理大规模网格时，效率仍有提升空间。
2. **扩展到其他数据类型**：将该方法扩展到点云或体积数据等其他几何表示。
3. **与其他技术结合**：探索如何将鲁棒统计方法与其他表面逼近技术（如移动最小二乘法）结合，以进一步提高鲁棒性和抗噪性。



# 原文翻译


**非迭代特征保持网格平滑方法**

**Thouis R. Jones（MIT）、Frédo Durand（MIT）、Mathieu Desbrun（USC）**

**图 1**：龙模型（左侧）被人为添加高斯噪声（$\sigma$ 为平均边长的 $1/5$）（中间），然后通过我们的方法进行单次平滑处理（右侧）。请注意，诸如锐角等特征被保留下来。

## 摘要

随着几何扫描仪在创建三维模型中的应用日益增加，快速且鲁棒的网格平滑技术的需求也在不断增长，以去除测量中不可避免的噪声。尽管以往的研究大多倾向于使用基于扩散的迭代技术来实现特征保持平滑，我们却提出了一种截然不同的方法，该方法基于鲁棒统计和局部表面一阶预测器。我们局部估计的鲁棒性使得我们可以推导出一种适用于任意“三角形汤”的非迭代特征保持滤波技术。我们展示了其实现的简单性和效率，这使得它成为平滑大型、噪声较多且非流形网格的绝佳解决方案。

**关键词**：网格处理、网格光顺、鲁棒估计、网格平滑、各向异性扩散、双边滤波。


## 1. 引言


随着几何扫描仪的普及以及扫描模型数量和复杂性的增长，鲁棒且高效的几何处理变得越来越重要。即使使用高保真扫描仪，获取的三维模型也总是带有噪声 [Rusinkiewicz et al. 2002; Levoy et al. 2000]，因此需要进行平滑处理。同样，从体积数据（例如通过 MRI 或 CT 设备获得）中提取的形状通常也包含大量的拓扑噪声 [Guskov and Wood 2001; Wood et al. 2002] 或几何噪声 [Taubin 1995; Desbrun et al. 1999]，这些噪声必须在进一步处理之前被去除。然而，在去除噪声的同时保持形状特征并非易事。如果不特别小心，锐角特征往往会变得模糊。更糟糕的是，扫描网格通常存在裂缝和非流形区域。

### 1.1 以往研究

S近年来，已经提出了多种网格平滑算法。Taubin [1995] 开创性地提出了一种快速网格平滑技术，通过一种简单、线性且各向同性的方法来增强三角化表面的平滑度，而无需借助昂贵的泛函最小化。Desbrun et al. [1999] 将这种方法扩展到不规则网格，引入了几何流类比，并使用共轭梯度求解器安全地去除了稳定性条件，从而即使在大型网格上，也能在合理的时间内实现显著的平滑效果。随后又有其他改进，例如一种结合了几何平滑和参数化正则化的技术 [Ohtake et al. 2000]。然而，这些高效的技术都是各向同性的，因此会不加区分地平滑噪声和显著特征：如果输入是一个噪声较多的立方体，它会在变得平滑之前变得极其圆润。这种缺乏选择性的特点限制了它们的应用范围。

最近，一些研究提出了特征保持的表面光顺技术 [Desbrun et al. 2000; Clarenz et al. 2000; Meyer et al. 2002; Zhang and Fiume 2002; Bajaj and Xu 2003]，这些技术大多受到图像处理中尺度空间和各向异性扩散工作的启发 [Perona and Malik 1990]。这些方法背后的思想是修改扩散方程，使其变为非线性和/或各向异性的。曲率张量决定了局部扩散，从而保持（甚至增强）锐角特征。尽管这些方法的结果质量更高，但它们依赖于冲击形成来保持细节，这会影响扩散方程的数值条件。即使在对数据进行平滑处理后，这也可能导致显著的计算时间。

其他研究人员提出了对法线场本身进行扩散型平滑 [Taubin 2001; Belyaev and Ohtake 2001; Ohtake et al. 2002; Tasdizen et al. 2002]；通过首先平滑法线场，然后使表面演化以匹配新的法线来实现光顺。同样，这些方法的结果优于各向同性技术，但其计算成本与网格上的各向异性扩散大致相当。

Peng et al. [2001] 成功地将局部自适应维纳滤波应用于三维网格，Pauly and Gross [2001] 则应用于点采样表面。然而，这些方法依赖于半规则连通性或局部参数化。Alexa [2002] 采用了一种不同的方法，类似于各向异性扩散，但使用更大的邻域进行滤波。这种方法也很快，避免了下面讨论的一些限制，但仍然依赖于连通网格和迭代应用。

本质上，基于扩散的特征保持技术都是局部且迭代的。从非常局部的导数近似开始，几何形状会迭代更新，直到噪声被充分扩散。可以使用数值工具（如预条件共轭梯度求解器或代数多重网格求解器）来提高效率，使迭代更加稳定。然而，这些方法的基础——扩散型设置——需要流形性，而原始扫描数据并不总是具备这一特性。为了满足对鲁棒且快速特征保持平滑的需求，我们提出将网格滤波视为鲁棒统计估计的一个案例。

### 1.2 鲁棒统计

鲁棒统计领域致力于开发对异常值和理论分布偏差具有鲁棒性的统计估计器 [Huber 1981; Hampel et al. 1986]。像最小二乘法这样的天真估计器会赋予异常值过多的权重，因为它们最小化的误差函数或范数对于远离估计器的数据点来说是很大的（最小二乘法的情况下是二次的）。相比之下，鲁棒估计器基于最小化一种能量，这种能量对异常值赋予低权重，如图 2 所示的高斯鲁棒范数：在距离估计器一定距离后，由尺度 $\sigma$ 控制，越来越远的异常值只会产生有限的影响。

**图 2**：最小二乘法与高斯误差范数的对比（根据 [Black et al. 1998] 改编）。

Black et al. [1998] 指出，各向异性扩散可以在鲁棒统计框架内进行分析。各向异性扩散的边缘停止函数 [Perona and Malik 1990] 与鲁棒能量函数的作用相同。各向异性扩散通过迭代方法最小化这种函数。

双边滤波器是由 Smith and Brady [1997]（参见 [Tomasi and Manduchi 1998]）提出的一种替代性的边缘保持滤波器。在像素 $p$ 处的输出 $E(p)$ 是输入图像 $I$ 中周围像素的加权平均值，其中像素 $q$ 的权重不仅取决于空间距离 $\|q - p\|$，还取决于信号差异 $\|I(q) - I(p)\|$：
$$
E(p) = \frac{1}{k(p)} \sum_{q \in \Omega} I(q) f(q - p) g(I(q) - I(p)), \tag{1}
$$
其中 $k(p)$ 是归一化因子
$$
k(p) = \sum_{q \in \Omega} f(q - p) g(I(q) - I(p)). \tag{2}
$$
在实践中，通常使用空间高斯函数 $f$ 和高斯影响权重 $g$。

这种对信号差异的依赖使得可以减少异常值的影响力。Durand and Dorsey [2002] 指出，双边滤波是一种鲁棒估计器，高斯影响权重对应于最小化高斯误差范数。他们还指出，双边滤波本质上与各向异性扩散相似。然而，双边滤波是一种非迭代的鲁棒估计器，或者说是 $W$ 估计器 [Huber 1981]，这使得它比迭代方案更高效。特别是，这种方法不需要处理强边缘处的冲击形成，因此比各向异性扩散更稳定。还可以参考 Barash [2001] 和 Elad [2002] 的相关工作。

### 1.3 本文贡献

在本文中，我们提出了一种基于非迭代鲁棒统计估计的新型任意表面网格特征保持光顺技术。与以往基于扩散的方法相比，我们的快速且稳定的方法依赖于局部鲁棒形状估计。此外，我们的方法不需要输入数据的流形性，因此可以应用于“三角形汤”。

我们的一项关键见解是，特征保持平滑可以被视为在存在异常值的情况下估计表面。将现有的鲁棒统计技术扩展到表面滤波并非易事，因为数据的性质：在网格中，空间位置和信号是同一个。这使得异常值的定义及其影响力的控制变得具有挑战性。我们提出通过定义局部一阶预测器来捕捉表面的平滑度。使用鲁棒估计器，我们将每个顶点的新位置作为其空间邻域内预测的加权和。我们将展示我们的方法将锐角特征两侧的点视为彼此的异常值。这限制了跨角的平滑，从而保持了特征。


## 2. 非迭代特征保持网格平滑

我们将特征保持网格滤波视为顶点位置上的鲁棒估计问题。通过从附近的三角形预测来计算顶点的估计值。将每个顶点移动到其位置的鲁棒估计值可以去除噪声并平滑网格，同时保持特征。

### 2.1 顶点位置的鲁棒估计

为了正确定义异常值，我们必须将空间位置和信号分开。我们通过一阶预测器（即切平面）来捕捉表面的平滑度。在实践中，我们使用基于网格三角形的预测器，因为它们是表面的自然切平面。由三角形 $q$ 定义的表面预测器 $\Pi_q$ 就是 $q$ 的切平面（见图 3a）。我们使用一种类似于图像双边滤波的方法 [Smith and Brady 1997; Tomasi and Manduchi 1998]，但我们根据其空间邻域内三角形的预测 $\Pi_q(p)$ 来估计顶点 $p$ 的新位置。

**图 3**：（a）基于 $q$ 处的表面预测点 $p$ 的预测 $\Pi_q(p)$ 是将 $p$ 投影到 $q$ 处的切平面上。位于锐角特征两侧的点会导致预测值距离较远，因此被赋予较少的权重。（b）噪声法线可能导致预测效果不佳。（c）法线平滑可以缓解这一问题。注意，由于点在平滑过程中不会移动，因此可以保留角特征：只有法线被平滑。

我们使用一个空间权重 $f$，它取决于顶点 $p$ 与三角形质心 $c_q$ 之间的距离 $\|p - c_q\|$。我们还使用一个影响权重 $g$，它取决于预测值与原始位置之间的距离 $\|\Pi_q(p) - p\|$。最后，我们根据三角形的面积 $a_q$ 来加权，以考虑表面采样率的变化。顶点 $p$ 在表面 $S$ 上的估计值 $p'$ 则为：
$$
p' = \frac{1}{k(p)} \sum_{q \in S} \Pi_q(p) a_q f(\|c_q - p\|) g(\|\Pi_q(p) - p\|), \tag{3}
$$
其中 $k$ 是归一化因子（权重之和）
$$
k(p) = \sum_{q \in S} a_q f(\|c_q - p\|) g(\|\Pi_q(p) - p\|). \tag{4}
$$
在本文中，空间权重 $f$ 和影响权重 $g$ 都使用高斯函数。当然，也可以使用其他鲁棒影响权重，但在我们的实验中，高斯函数表现良好，正如其他研究者 [Smith and Brady 1997; Tomasi and Manduchi 1998; Durand and Dorsey 2002] 的工作所展示的那样。平滑程度由空间权重高斯函数的宽度 $\sigma_f$ 和影响权重高斯函数的宽度 $\sigma_g$ 控制。正如图 3(a) 所示，来自锐角特征两侧的预测值由于距离较大，会被影响权重 $g$ 处罚，因此被赋予较少的权重。

对网格进行滤波涉及对每个顶点评估方程 (3)，然后将它们作为一个整体移动到它们的估计位置。请注意，除了三角形之外不需要任何连通性：我们只需使用欧几里得距离到周围三角形的质心来找到顶点的空间邻域。更宽的空间滤波器会包含更多的邻居用于估计，因此可以去除更多的噪声，或者平滑更大的特征。影响权重决定了何时将邻居的预测视为异常值（通过赋予它们较少的权重），从而控制在滤波中保留的特征大小。

正如 Black et al. [1998] 和 Durand and Dorsey [2002] 所指出的，方程 (3) 的评估对应于近似最小化
$$
E(p) = \int_{q \in S} f(\|c_q - p\|) \rho(\|\Pi_q(p) - p\|) \, dq, \tag{5}
$$
其中 $\rho(\|\Pi_q(p) - p\|)$ 是在鲁棒误差范数 $\rho$ 下顶点与其预测位置之间的距离 [Hampel et al. 1986]。在我们的例子中，我们试图最小化高斯误差范数（见图 2）；$\rho$ 和 $g$ 之间的关系是 $g(x) \equiv \rho'(x)/x$ [Black et al. 1998; Durand and Dorsey 2002; Hampel et al. 1986]。

### 2.2 平滑

我们的预测器基于切平面的方向，如前面所述，这些方向是由面片法线定义的。由于法线是网格的一阶属性，它们比顶点位置更容易受到噪声的影响（见图 3(b)）。尽管如此，鲁棒估计器仍然表现良好；然而，我们可以通过平滑来显著改进估计器。我们通过平滑法线来平滑估计器。

我们首先进行一次非鲁棒平滑，使用方程 (3)，但不使用影响权重，并且使用最简单的预测器，$\Pi_q(p) = c_q$，对应于简单的高斯平滑。我们在平滑过程中使用不同的空间滤波器宽度，并且在实践中总是将其设置为 $\sigma_f/2$。然后将平滑后的网格的法线复制到原始网格的面片上，再进行鲁棒滤波。请注意，我们根本没有改变顶点的位置：我们只需要平滑法线（一阶属性），而不是零阶位置（见图 3(c)）。有些法线可能在角附近被不恰当地平滑。这就是为什么在平滑过程中不移动顶点很重要，以保留这些特征。图 4 展示了有无平滑的滤波效果对比。如果没有平滑，网格的面片法线会更加嘈杂，导致平滑效果不佳。

**图 4**：各向同性滤波与我们的方法对比。请注意，细节（如上下眼睑和眼睛）被更好地保留，而平坦区域的平滑效果相当。（原始网格由 Jean-Yves Bouguet 提供。）

### 2.3 特征保持

我们提出的滤波方法通过两种联合行动来保持特征。首先是使用鲁棒影响权重函数，如前所述，而第二个是我们使用基于网格切平面的顶点位置预测器。这两个行动单独都不足以实现特征保持（见下文关于图 7 的讨论，了解影响权重如何影响滤波器）。然而，它们共同提供了出色的特征保持行为。请注意与图像双边滤波的联系，它使用分段常数图像的先验。这是我们的公式的一个特例，对应于预测器 $\Pi_q(p) = c_q$。此外，使用现有的网格面片简化了我们的公式及其实现，因为它们直接提供了表面切线的估计。

本质上，我们的技术也与 ENO/WENO 方法 [Osher and Fedkiw 2002] 有关，这是一类用于双曲型偏微分方程积分的基于有限差分的、捕捉激波的数值技术。简而言之，它们试图避免激波的耗散——在我们的几何设置中，相当于锐角特征。它们仅基于与场值相似的局部邻居来局部评估微分量。例如，在激波处评估二阶导数时，不会使用中心差分，因为这会使用两侧的信息；相反，评估是一侧的，以防止数值耗散。鲁棒统计为将类似的关键概念扩展到几何学提供了一个合理的框架。

## 3. 实验结果

我们在图 1 和图 4-8 中展示了我们的实验结果。在每种情况下，我们都使用高斯函数作为空间权重 $f$、影响权重 $g$ 和平滑滤波器，标准差分别为 $\sigma_f$、$\sigma_g$ 和 $\sigma_f/2$。这种选择对应于高斯误差范数。所有网格均以平顶阴影渲染，以显示分面效果。表 1 总结了我们的结果以及生成它们所使用的参数，以特定网格的平均边长（$\|e\|$）表示。平滑参数的选择对结果影响很大，因此我们在图 5 中展示了一些关于参数选择的实验结果。

**图 5**：（a）对于被高斯噪声污染的网格，不同噪声方差下最优的 $\sigma
_f$ 和 $\sigma_g$ 值。（b）对于给定噪声水平，随着 $\sigma_f$ 和 $\sigma_g$ 的变化，滤波误差的演变。所有值均以平均边长为单位。

**表1**：在1.4GHz的Athlon处理器和2GB内存的计算机上得到的结果。时间不包括加载网格的时间。$\sigma$值表示为平均边长$\|e\|$的比例，括号中的数字表示特定网格的边界框对角线的千分之一。

在图 4 中，我们展示了从头部的三维扫描中提取的一个网格片段。我们展示了原始网格、Desbrun et al. [1999] 的各向同性平滑结果以及我们的技术结果。我们展示这一对比是为了证明我们的方法在平滑噪声较多且存在拓扑错误的网格方面的有效性。

在图 6 中，我们展示了我们的方法与 Peng et al. [2001] 的维纳滤波方法的对比。我们选择我们的方法的参数以在视觉上匹配平坦区域的平滑度。我们的方法在较大程度的平滑下能够更好地保持特征（见图 6(d) 和 6(e)）。此外，正如前面提到的，维纳滤波需要将输入重新采样为半规则网格，并且只适用于具有流形拓扑的表面，而我们的方法可以更广泛地应用于非规则和不连通的网格。我们估计他们的实现需要大约 15 秒来滤波这个网格，而我们的技术需要 60 秒或更长时间（具体取决于平滑参数）。

在图 10 中，我们将我们的方法与 Clarenz et al. [2000] 的各向异性扩散平滑方法进行了对比。原始的、噪声较多的网格通过四次扩散迭代被平滑，较小的特征被移除。我们选择了我们的方法的参数以尽可能接近地匹配结果。各向异性扩散的一个优点是能够通过迭代增强边缘和角。我们的方法无法在单次传递中执行这样的增强，导致整体外观略有不同，特别是在毛发部分，模型边缘周围的噪声略多。

我们还在图 10 中展示了置信度度量 $k$ 的伪彩色图。正如所见，平滑区域（如脸颊）和被平滑区域包围的特征（如鼻子的边缘）具有较高的置信度，而弯曲区域或靠近更复杂特征的区域具有较低的置信度。请参见图 8。

我们在图 7 中展示了改变空间和影响权重函数宽度的效果。对于宽空间滤波器但窄影响权重，网格仅在大部分平坦区域被平滑。反之，对于窄空间滤波器和宽影响权重，小特征被移除，但较大的变化得以保留。最后，对于宽空间滤波器和宽影响权重，仅保留最大和最强的特征。请参见图 8，以了解我们方法用于移除网格除最显著特征外的所有内容的类似示例。

为了便于使用我们的方法进行去噪，我们进行了实验，以找到平滑被给定量噪声污染的模型的良好 $\sigma_f$ 和 $\sigma_g$ 值，例如扫描仪可能产生的噪声。如果可以通过检查模型上已知平坦区域的噪声量来量化噪声量，那么图 5(a) 中的曲线图显示了我们实验中的最优 $\sigma_f$ 和 $\sigma_g$ 值。这些值已在多个模型上被证明是有效的。图 5(b) 中的曲面图显示了对于特定（代表性）噪声水平，滤波后的误差如何随 $\sigma_f$ 和 $\sigma_g$ 的变化而变化。正如所见，误差对 $\sigma_f$ 更敏感。我们通过计算原始网格在被污染之前与滤波网格之间的 $L_2$ 距离来计算误差 [Khodakovsky et al. 2000]。

在其他应用中，我们通常的做法是将 $\sigma_f$ 和 $\sigma_g$ 同时增加，直到滤波网格足够平滑以满足我们的目标。然后，我们减少 $\sigma_g$，直到我们试图移除的特征或噪声开始重新出现。

我们的所有结果都证明了我们的技术在特征保持方面的有效性，这是由于鲁棒影响权重函数和一阶预测器的结合，如第 2.3 节所述。特别是，兔子的耳朵尖端、龙的头部和四肢等特征得以保留。请参见图 9，这是对折纸作品的一部分的扫描。

我们在图 1 中展示了我们的滤波方法对被合成噪声污染的网格的应用。在噪声网格中，每个顶点沿法线方向被零均值高斯噪声位移，噪声标准差 $\sigma_{\text{noise}}$ 为平均边长的 $1/5$。我们对龙网格进行滤波，以恢复原始形状的估计值。为了进行对比，在图 4 中的扫描网格中，我们估计 $\sigma_{\text{noise}} \approx 1/7$。这些结果展示了我们的方法在极端噪声存在的情况下进行平滑的能力。图 4 还指出我们的算法可以改进的一个地方。当特征和噪声重合时（例如在鼻子处），很难正确区分它们。在图 1 中，我们旨在实现更平滑的重建，但在此过程中丢失了一些细节。

我们对我们的实现应用了两种基本优化。我们将在 $2\sigma_f$ 处截断空间滤波器，以限制每个顶点必须考虑的估计值的数量。这并没有明显影响结果。我们还将顶点和面片在空间上分组进行处理，以提高局部性。

如所呈现的，我们的方法不一定是体积保持的。我们尚未遇到这是一个问题的网格。在滤波后调整网格以保持其体积是一个简单的扩展 [Desbrun et al. 1999]。

## 4. 结论与未来工作

我们开发了一种新颖的快速特征保持表面平滑和去噪技术，适用于三角形汤。我们使用一阶预测器来捕捉平滑物体的局部形状。这将信号和空间位置在表面上解耦，并允许我们使用鲁棒统计作为特征保持的坚实基础。将鲁棒误差范数应用于预测器和顶点位置，从中我们推导出一个高效且稳定的单步平滑算子。平滑用于更好地捕捉形状，并获得更可靠的异常值和特征检测。我们在多个模型上展示了我们的算法，用于噪声去除和网格平滑。

与本工作同时进行的是 Fleishman et al. [2003]，他们提出了将双边滤波扩展到网格的方法，其目标与我们的工作相似，但采用了不同的方法。主要区别在于，他们通过从网格计算顶点法线来进行局部投影，然后将顶点的更新位置计算为其邻域作为高度场的双边滤波。粗略地说，他们的方法更快，但需要连通网格。速度提升的原因有两个：他们没有平滑法线，并且网格中的三角形密度大约是顶点的一半。他们需要连通性来估计法线。他们还将滤波器迭代应用，而我们专注于单次传递技术。这两种方法在形成顶点滤波位置的预测方面存在根本性差异。我们的方法将中心顶点投影到附近三角形的平面上，而 Fleishman 等人的方法将附近顶点投影到中心顶点的平面上。这两种方法的相对成本和收益值得进一步研究。还有几条途径可以改进我们的方法。

方程 (3) 中的归一化因子 $k$ 是应用于点邻域中各个估计值的权重之和（见图 10）。因此，它提供了一个置信度量，应该被附加到点新位置的估计值上，正如 Durand and Dorsey [2002] 所指出的。我们在这项工作中没有使用置信度量 $k$，但我们认为它在未来的方法中可能是一个有价值的工具。特别是，我们相信它可以用来检测无法形成良好估计的区域，如图 1 中的锐角特征。这些区域可以通过迭代滤波等方式进行进一步处理。

在我们的经验中，我们的算法的 $O(\sigma_f^2)$ 增长率并不是一个限制因素。如果它成为限制因素，一个有希望的方法是通过简化网格来对网格进行下采样，然后根据简化版本对原始网格顶点进行滤波。我们的方法应该也可以轻松扩展到外核评估，因为它不需要连通性信息，并且计算是空间局部的。这将允许我们的方法应用于极其大型的模型。

最后，将鲁棒统计扩展到网格暗示了其他可能性。影响权重可以包括网格上的其他数据，例如颜色。将我们的滤波器扩展到其他形状表示（如体积数据或点采样模型 [Zwicker et al. 2002]）也应该很直接。在后一种情况下，每个样本都包含一个法线，方法和结果可以直接转移。我们还计划探索如何将鲁棒统计添加到现有的表面近似技术中，例如移动最小二乘法 [Levin 2001]，以提高它们的鲁棒性和抗噪性。
