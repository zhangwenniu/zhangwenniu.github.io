---
layout: mypost
title: k033 A Phenomenological AI Foundation Model for Physical Signals
categories: [物理, Transformer]
---

# 论文链接

- [智源社区](https://hub.baai.ac.cn/paper/80e61b3e-d16e-4161-b85e-ae2ff309e4d6)

- [Arxiv Link](https://arxiv.org/abs/2410.14724v1)



# 论文重点难点讲解

## 论文重点

1. **目标与方法**  
   论文提出了一种基于现象学框架的AI基础模型（foundation model），用于处理和泛化各种物理信号。该模型不依赖于物理定律或归纳偏差的先验知识，而是通过大量跨模态传感器数据进行训练，以实现对不同物理现象、领域、应用和传感器装置的泛化能力。

2. **数据与模型架构**  
   - 模型在0.59亿个样本上进行训练，涵盖从电流到流体流动再到光学传感器的多种传感器测量。
   - 采用Transformer架构作为编码器，将传感器数据编码为统一的嵌入空间，并通过轻量级的解码器进行轨迹重建和预测。

3. **实验验证**  
   - **零样本学习能力**：模型展示了对未见过的物理现象（如热电效应）的零样本推断能力。
   - **泛化能力**：在多个复杂物理过程（如电力系统动态、气象参数）上，模型的零样本性能优于专门针对目标数据训练的模型。

4. **结论与意义**  
   论文证明了构建一个统一的AI基础模型用于多样化物理过程的可行性，这种模型可以像大型语言模型（LLMs）一样，通过大量数据学习物理过程的底层结构。


## 论文难点

1. **现象学框架的实现**  
   - 如何确保模型能够从有限的观测数据中学习到物理过程的通用表示，同时避免过拟合到特定传感器或数据集的特性。
   - 传感器引入的噪声和失真可能影响模型对真实物理量的准确学习。

2. **模型的泛化能力**  
   - 尽管模型在多个实验中展示了泛化能力，但在某些复杂物理过程（如非周期信号或异常情况）中，模型的表现仍需进一步验证。
   - 传感器采样频率和数据分布的变化对模型性能有显著影响，需要更好的处理方法。

3. **解码器的设计与优化**  
   - 轻量级解码器的设计需要在保持高效的同时，能够适应不同任务（如重建和预测）的需求。
   - 如何通过少量目标数据对解码器进行微调，以进一步提升模型性能，仍是一个开放问题。

4. **模型的可扩展性**  
   - 如何扩展模型以处理更广泛的物理现象和传感器类型，同时保持其零样本学习能力。
   - 对于复杂系统的泛化能力，尤其是在训练数据有限的情况下，模型的有效性仍需进一步研究。

# 论文详细讲解

## 1. 研究背景与动机
论文旨在开发一种能够泛化于多种物理现象、领域、应用和传感器装置的AI基础模型。该模型采用现象学方法，不依赖于物理定律或归纳偏差的先验知识，而是通过大量跨模态传感器数据进行训练，以实现对物理过程的通用表示和预测。这一方法受到自然语言处理（NLP）中Transformer架构的启发，例如GPT-4，这些模型通过自监督学习在大规模文本数据上表现出色。

## 2. 现象学框架（Ω-Framework）
论文提出了一个现象学框架来构建通用模型，该框架的核心是将物理世界中的所有可观测量（$q_i(t)$）视为一个超集Ω。尽管直接训练一个涵盖Ω的模型在实践中不可行，但作者探讨了通过一个代表性子集（$\omega \in \mathcal{W}$）训练的模型是否能够推断出未见过的物理量（$q_{\lambda'} \notin \omega$）的行为。

- **物理量与传感器测量**  
  由于物理量无法直接观测，只能通过传感器（$s_j$）间接测量，传感器将真实的物理量（$q_i(t)$）转换为测量值（$m_{i,j}(t)$），并引入噪声和失真。测量值的分布可以用条件概率密度函数$p_{M|Q}(m_{i,j}|q_i)$描述。

- **模型公式化**  
  模型的目标是将测量值（$m_{i,j}(t)$）编码为一个潜在表示（$z_{\text{emb},i,j}$），并能够通过解码器重构过去轨迹（$g^-$）和预测未来轨迹（$g^+$）：
  $$
  f: m_{i,j}(t) \rightarrow z_{\text{emb},i,j}, \\
  g^-: z_{\text{emb},i,j} \rightarrow \tilde{m}_{i,j}(t), \quad \text{for } t \leq T, \\
  g^+: z_{\text{emb},i,j} \rightarrow \tilde{m}_{i,j}(t), \quad \text{for } t > T.
  $$

## 3. 模型设计与训练
论文设计了一个基于Transformer的编码器和轻量级解码器的架构。

- **编码器设计**  
  编码器将传感器数据划分为固定长度的一维片段（patch），并将其投影到统一的嵌入空间。具体步骤如下：
  1. **数据预处理**：将测量值（$m_{i,j}(t)$）归一化到[0,1]范围，并划分为长度为$l_{\text{patch}}$的片段。
  2. **投影到嵌入空间**：通过线性层将片段投影到维度为$d_{\text{model}}$的嵌入空间，并添加位置嵌入以保留时间顺序。
  3. **Transformer架构**：使用6层标准Transformer架构，包含因果多头注意力机制和前馈网络。最终输出的嵌入向量（$z_{\text{emb},i,j}$）作为物理量的表征。

- **解码器设计**  
  解码器用于从嵌入向量重构过去轨迹（$g^-$）和预测未来轨迹（$g^+$）。解码器采用两层MLP架构，具体参数根据任务调整。

- **训练过程**  
  模型使用41个公开数据集进行预训练，包含5.95亿个观测样本，覆盖多种物理现象和传感器类型。预训练任务包括重构和预测，采用自监督学习，损失函数为重构和预测的均方误差（MSE）加权和。预训练完成后，通过冻结编码器权重并微调解码器来适应特定任务。

## 4. 实验验证
论文通过两组实验验证模型的泛化能力和零样本学习能力。

- **经典系统实验**  
  1. **机械振子实验**  
     实验设置为一个弹簧-质量系统，通过加速度计测量其运动。模型能够预测不同阶段的振荡行为，平均MSE为0.00968，表现出从混沌到规律振荡的性能提升。
  2. **热电效应实验**  
     实验基于Seebeck效应，通过测量温差产生的电流来验证模型。模型在零样本预测中表现出色，平均MSE为$1.5 \times 10^{-4}$。

- **复杂物理过程实验**  
  作者选择了5个未包含在训练数据中的复杂物理过程进行验证，包括气象参数、电力系统动态等。实验结果表明，零样本模型在重构和预测任务中均优于仅在目标数据上训练的模型。例如，零样本模型的平均预测MSE比目标训练模型低23%，而重构任务中低34%。

## 5. 结论与讨论
论文证明了通过大规模多样化物理数据训练的AI基础模型能够泛化到未见过的物理现象、传感器类型和复杂应用领域。模型展示了零样本学习能力，例如在未见过热电效应的情况下能够准确预测相关动态。此外，论文指出该模型与大型语言模型（LLMs）类似，可能捕捉到了物理过程的底层结构，而不仅仅是数据模式。

## 6. 未来工作
论文指出未来研究的方向包括：
1. 探索传感器特性对模型性能的影响，尤其是传感器引入的噪声和失真。
2. 研究模型在非周期信号、异常情况和人为干预下的表现。
3. 设计更高效的下游解码器架构，以适应更多实际应用场景。

通过这些研究，论文为开发能够处理多样化物理信号的统一AI模型提供了新的思路，并为未来的研究和应用奠定了基础。

# 论文数据获取部分详细讲解

## 1. 数据集来源
论文使用了41个公开数据集进行模型预训练，这些数据集涵盖了多种物理现象、传感器类型和应用领域。这些数据集的来源包括但不限于气象数据、电力系统数据、交通流量数据和能源消耗数据等。

## 2. 数据集特点
这些数据集具有以下特点：
- **多样性**：数据集包含了从气象参数（如温度、湿度）到电力系统动态（如变压器油温、电网负荷）的多种物理过程。
- **大规模**：数据集总计包含约5.95亿个观测样本，覆盖了不同采样频率和噪声水平的测量数据。
- **跨模态**：数据集中的物理量通过不同类型的传感器进行测量，例如加速度计、电流传感器和气象传感器。

## 3. 数据集示例

论文中列举了部分用于预训练的数据集及其特点：

| Dataset | Repository | Domain | # observations |
|--|--|--|--|
| LOOP_SEATTLE | LibCity | Transport | 33953760 |
| LOS_LOOP | LibCity | Transport | 7094304 |
| PEMS03 | LibCity | Transport | 9382464 |
| PEMS07 | LibCity | Transport | 24921792 |
| PEMS_BAY | LibCity | Transport | 16937700 |
| SZ_TAXI | LibCity | Transport | 464256 |
| australian_electricity_demand | Monash | Energy | 1153584 |
| bdg - 2_bear | BuildingsBench | Energy | 1482312 |
| bdg - 2_fox | BuildingsBench | Energy | 2324568 |
| bdg - 2_panther | BuildingsBench | Energy | 919800 |
| bdg - 2_rat | BuildingsBench | Energy | 4728288 |
| borealis | BuildingsBench | Energy | 83269 |
| bull | ProEnFo | Energy | 719304 |
| cockatoo | ProEnFo | Energy | 17544 |
| covid19_energy | ProEnFo | Energy | 31912 |
| elecdemand | Monash | Energy | 17520 |
| elf | ProEnFo | Energy | 21792 |
| gfc12_load | ProEnFo | Energy | 788280 |
| gfc14_load | ProEnFo | Energy | 17520 |
| gfc17_load | ProEnFo | Energy | 140352 |
| hog | ProEnFo | Energy | 421056 |
| ideal | BuildingsBench | Energy | 1265672 |
| kdd2022 | Other | Energy | 4727519 |
| kdd_cup_2018_with_missing | Monash | Energy | 2897004 |
| london_smart_meters_with_missing | Monash | Energy | 166238880 |
| oikolab_weather | Monash | Climate | 800456 |
| pdb | ProEnFo | Energy | 17520 |
| pedestrian_counts | Monash | Transport | 3130762 |
| saugeenday | Monash | Nature | 23711 |
| sceaux | BuildingsBench | Energy | 34223 |
| smart | BuildingsBench | Energy | 95709 |
| solar_power | Monash | Energy | 7397222 |
| spain | ProEnFo | Energy | 35064 |
| subseasonal_precip | SubseasonalClim | Climate | 9760426 |
| sunspot_with_missing | Monash | Nature | 73894 |
| taxi_30min | GluonTS | Transport | 54999060 |
| traffic_hourly | Monash | Transport | 14978112 |
| uber_tlc_hourly | GluonTS | Transport | 1129444 |
| weather | Monash | Climate | 42941700 |
| wind_farms_with_missing | Monash | Energy | 172165370 |
| wind_power | Monash | Energy | 7397147 |

Figure 8: Datasets used for training

## 4. 数据预处理
在预训练之前，数据经过以下预处理步骤：
- **归一化**：所有测量值被归一化到[0,1]范围内，以消除不同传感器和物理量之间的量纲差异。
- **分段处理**：测量值被划分为固定长度的一维片段（patch），每个片段的长度为$l_{\text{patch}}$。
- **降采样与滤波**：对于高频数据，如气象传感器数据，可能需要进行降采样和滤波以减少噪声。

## 5. 数据集的作用
这些数据集的作用是为模型提供丰富的物理过程样本，使其能够学习到不同物理现象的通用特征和模式。通过在多样化数据上进行预训练，模型能够泛化到未见过的物理现象和传感器类型。

## 6. 数据集的局限性
尽管数据集规模庞大且多样化，但论文也指出其局限性：
- 数据集可能无法完全覆盖所有物理现象，尤其是在复杂系统或非周期信号方面。
- 不同传感器的特性（如噪声水平和采样频率）可能对模型性能产生影响。

通过这些数据集，论文展示了如何利用大规模多样化数据训练一个能够泛化于多种物理现象的AI基础模型。

# 方法部分详细讲解

## 1. 现象学框架（Framework）
论文提出了一个现象学框架（Framework），用于构建能够泛化于多种物理现象的AI基础模型。该框架的核心是将物理世界中的所有可观测量（$q_i(t)$）视为一个超集 $\mathcal{W}$，并探讨通过一个代表性子集（$\omega \in \mathcal{W}$）训练的模型是否能够推断出未见过的物理量（$q_{\lambda'} \notin \omega$）的行为。

## 2. 物理量与传感器测量
物理量（$q_i(t)$）无法直接测量，只能通过传感器（$s_j$）间接观测。传感器将物理量转换为测量值（$m_{i,j}(t)$），并引入噪声和失真。测量值与真实物理量之间的关系可以用条件概率密度函数 $p_{M|Q}(m_{i,j}|q_i)$ 描述。

## 3. 模型公式化
模型的目标是将测量值（$m_{i,j}(t)$）编码为一个潜在表示（$z_{\text{emb},i,j}$），并能够通过解码器重构过去轨迹（$g^-$）和预测未来轨迹（$g^+$）：
$$
f: m_{i,j}(t) \rightarrow z_{\text{emb},i,j}, \\
g^-: z_{\text{emb},i,j} \rightarrow \tilde{m}_{i,j}(t), \quad \text{for } t \leq T, \\
g^+: z_{\text{emb},i,j} \rightarrow \tilde{m}_{i,j}(t), \quad \text{for } t > T.
$$

## 4. 模型设计与训练

### 4.1 编码器设计
编码器将传感器数据划分为固定长度的一维片段（patch），并将其投影到统一的嵌入空间。具体步骤如下：

1. **数据预处理**  
   将测量值（$m_{i,j}(t)$）归一化到 [0,1] 范围，并划分为长度为 $l_{\text{patch}}$ 的片段：
   $$
   P_{i,j} = \{p_{i,j,k}\}_{k=1}^n, \quad p_{i,j,k} \in \mathbb{R}^{l_{\text{patch}}}
   $$

2. **投影到嵌入空间**  
   通过线性层将片段投影到维度为 $d_{\text{model}}$ 的嵌入空间，并添加位置嵌入以保留时间顺序：
   $$
   T_{i,j} = \{t_{i,j,k}\}_{k=1}^n, \quad t_{i,j,k} = \text{Linear}(p_{i,j,k}) + r_k
   $$
   其中，$r_k \in \mathbb{R}^{d_{\text{model}}}$ 是可学习的位置嵌入。

3. **Transformer架构**  
   使用6层标准Transformer架构，包含因果多头注意力机制和前馈网络。最终输出的嵌入向量（$z_{\text{emb},i,j}$）作为物理量的表征：
   $$
   Z_{\text{emb},i,j} = \text{Transformer}(T_{i,j})
   $$

### 4.2 解码器设计
解码器用于从嵌入向量重构过去轨迹（$g^-$）和预测未来轨迹（$g^+$）。解码器采用两层MLP架构，具体参数根据任务调整：
- **重构解码器（$g^-$）**：输出维度等于输入测量值的点数（$d_{\text{out}} = n_{\text{patch}} \times l_{\text{patch}}$）。
- **预测解码器（$g^+$）**：输出维度等于预测窗口的长度（$d_{\text{out}} = l_{\text{pred}}$）。

### 4.3 训练过程
- **数据集**：使用41个公开数据集进行预训练，包含5.95亿个观测样本，覆盖多种物理现象和传感器类型。
- **预训练任务**：采用自监督学习，包括重构和预测任务，损失函数为重构和预测的均方误差（MSE）加权和：
  $$
  \mathcal{L} = 0.6 \cdot \text{MSE}_{\text{pred}} + 0.4 \cdot \text{MSE}_{\text{recon}}
  $$
- **优化器**：使用AdamW优化器，学习率为 $10^{-3}$，批量大小为1024。
- **微调**：冻结预训练编码器权重，仅对目标数据集的解码器进行微调。

## 5. 方法总结
论文通过提出一种现象学框架，结合Transformer编码器和轻量级解码器，构建了一个能够泛化于多种物理现象的AI基础模型。该模型通过大规模多样化数据进行预训练，并通过自监督学习任务（重构和预测）优化模型性能。通过冻结编码器权重并微调解码器，模型能够快速适应特定任务。



